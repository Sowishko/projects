unit Unit1;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls;

type
  TForm1 = class(TForm)
    Button1: TButton;
    Edit1: TEdit;
    procedure Button1Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form1: TForm1;
  Sum:Integer; {Переменная, в которую записывается результат вычислений }
  f:TextFile;				{файловая переменная}
  cs:TRTLCriticalSection;	{критическая секция}
  mt:THANDLE;			{Дескриптор объекта mutex}
  ev:THANDLE; 			{Дескриптор объекта "событие"}



implementation

{$R *.dfm}

procedure TForm1.Button1Click(Sender: TObject);
var Text:string;
    pFile: Pchar;
    Size: integer;
    hFile,hFileMap: THandle;
  begin
  hFile:=CreateFile('file1.txt',GENERIC_READ, FILE_SHARE_READ, nil, OPEN_EXISTING,FILE_ATTRIBUTE_NORMAL,0);
  Size:=GetFileSize(hFile,nil);
  hFileMap:=CreateFileMapping(hFile,nil,PAGE_READWRITE,0,Size,'RRR');
  pFile:=MapViewOfFile(hFileMap,FILE_MAP_ALL_ACCESS,0,0,0);

  mt:=CreateMutex(nil,false,PChar('Send'));
  Edit1.Text:=IntToStr(mt);

  end;

end.
